<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"gold-jack.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.13.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="docker基本命令和原理">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker">
<meta property="og:url" content="https://gold-jack.github.io/2022/09/28/notes/Docker/index.html">
<meta property="og:site_name" content="Jack&#39;s Blog">
<meta property="og:description" content="docker基本命令和原理">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gold-jack.github.io/typora-user-images/image-20220609163838158.png">
<meta property="og:image" content="https://gold-jack.github.io/typora-user-images/image-20220608123431133.png">
<meta property="og:image" content="https://gold-jack.github.io/typora-user-images/image-20220609180550711.png">
<meta property="og:image" content="https://gold-jack.github.io/typora-user-images/image-20220610113447054.png">
<meta property="og:image" content="https://gold-jack.github.io/typora-user-images/image-20220610113524356.png">
<meta property="article:published_time" content="2022-09-27T16:00:00.000Z">
<meta property="article:modified_time" content="2022-09-28T09:44:44.103Z">
<meta property="article:author" content="Gold_Jack">
<meta property="article:tag" content="middleware">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gold-jack.github.io/typora-user-images/image-20220609163838158.png">


<link rel="canonical" href="https://gold-jack.github.io/2022/09/28/notes/Docker/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://gold-jack.github.io/2022/09/28/notes/Docker/","path":"2022/09/28/notes/Docker/","title":"Docker"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Docker | Jack's Blog</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Jack's Blog" type="application/atom+xml">
<style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Jack's Blog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-Basics"><span class="nav-number">1.</span> <span class="nav-text">Docker Basics</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Docker-Installation-on-Ubuntu"><span class="nav-number">1.1.</span> <span class="nav-text">Docker Installation on Ubuntu</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#How-to-start-Docker-service"><span class="nav-number">1.2.</span> <span class="nav-text">How to start Docker service</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Basic-Commands"><span class="nav-number">1.3.</span> <span class="nav-text">Basic Commands</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Graph"><span class="nav-number">1.3.1.</span> <span class="nav-text">Graph</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-Images"><span class="nav-number">1.3.2.</span> <span class="nav-text">Docker Images</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-Containers"><span class="nav-number">1.3.3.</span> <span class="nav-text">Docker Containers</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-Volumes"><span class="nav-number">1.3.4.</span> <span class="nav-text">Docker Volumes</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#run-parameter-v-%E2%80%93volume"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">run parameter(-v, –volume)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dockerfile-VOLUME"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">Dockerfile(VOLUME)</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-History"><span class="nav-number">1.3.5.</span> <span class="nav-text">Docker History</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Docker-Inspect"><span class="nav-number">1.3.6.</span> <span class="nav-text">Docker Inspect</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Dockerfile"><span class="nav-number">1.4.</span> <span class="nav-text">Dockerfile</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ENTRYPOINT-and-CMD"><span class="nav-number">1.4.1.</span> <span class="nav-text">ENTRYPOINT and CMD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-to-build-my-own-image-by-Dockerfile"><span class="nav-number">1.4.2.</span> <span class="nav-text">How to build my own image by Dockerfile</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-write-Dockerfile"><span class="nav-number">1.4.2.1.</span> <span class="nav-text">1. write Dockerfile</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-build-myCentos-image"><span class="nav-number">1.4.2.2.</span> <span class="nav-text">2. build myCentos image</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-test-image"><span class="nav-number">1.4.2.3.</span> <span class="nav-text">3. test image</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Practice-Make-TOMCAT-Image"><span class="nav-number">2.</span> <span class="nav-text">Practice: Make TOMCAT Image</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Dockerfile"><span class="nav-number">2.1.</span> <span class="nav-text">1.Dockerfile</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-build-Image"><span class="nav-number">2.2.</span> <span class="nav-text">2.build Image</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Run-Iamge"><span class="nav-number">2.3.</span> <span class="nav-text">3.Run Iamge</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Test-Connection"><span class="nav-number">2.4.</span> <span class="nav-text">4.Test Connection</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-Create-WEB-INF-x2F-web-xml"><span class="nav-number">2.5.</span> <span class="nav-text">5.Create WEB_INF&#x2F;web.xml</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Create-index-jsp"><span class="nav-number">2.6.</span> <span class="nav-text">6.Create index.jsp</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-Test-localhost-9090-x2F-test"><span class="nav-number">2.7.</span> <span class="nav-text">7.Test localhost:9090&#x2F;test</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-Check-logs"><span class="nav-number">2.8.</span> <span class="nav-text">8.Check logs</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-Push-MyTomcat-to-DockerHub"><span class="nav-number">2.9.</span> <span class="nav-text">9.Push MyTomcat to DockerHub</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-Network"><span class="nav-number">3.</span> <span class="nav-text">Docker Network</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#How-does-docker-handle-container-network-access"><span class="nav-number">3.1.</span> <span class="nav-text">How does docker handle container network access?</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Veth-pair"><span class="nav-number">3.2.</span> <span class="nav-text">Veth-pair</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Communication-Process"><span class="nav-number">3.3.</span> <span class="nav-text">Communication Process</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ping-Test"><span class="nav-number">3.4.</span> <span class="nav-text">Ping Test</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E2%80%93link"><span class="nav-number">3.5.</span> <span class="nav-text">–link</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Network-Inspect"><span class="nav-number">3.6.</span> <span class="nav-text">Network Inspect</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hosts"><span class="nav-number">3.7.</span> <span class="nav-text">Hosts</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Create-My-Network"><span class="nav-number">3.8.</span> <span class="nav-text">Create My Network</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Customize-My-Network"><span class="nav-number">3.8.1.</span> <span class="nav-text">Customize My Network</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Inspect-Mynet"><span class="nav-number">3.8.2.</span> <span class="nav-text">Inspect Mynet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-Two-Tomcats-Running-in-Mynet"><span class="nav-number">3.8.3.</span> <span class="nav-text">Create Two Tomcats Running in Mynet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Again-Inspect-Mynet"><span class="nav-number">3.8.4.</span> <span class="nav-text">Again: Inspect Mynet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Ping-Test-Between-Tomcat-net-01-and-Tomcat-net-02"><span class="nav-number">3.8.5.</span> <span class="nav-text">Ping Test Between Tomcat-net-01 and Tomcat-net-02</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Summary"><span class="nav-number">3.8.6.</span> <span class="nav-text">Summary</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#New-Container-to-Mynet"><span class="nav-number">3.8.7.</span> <span class="nav-text">New Container to Mynet</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Two-IP-One-Container"><span class="nav-number">3.8.8.</span> <span class="nav-text">Two IP One Container</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Docker-compose"><span class="nav-number">4.</span> <span class="nav-text">Docker-compose</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Introduction"><span class="nav-number">4.1.</span> <span class="nav-text">Introduction</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Intallation"><span class="nav-number">4.2.</span> <span class="nav-text">Intallation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Download-Docker-compose"><span class="nav-number">4.2.0.1.</span> <span class="nav-text">Download Docker-compose</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Authorize"><span class="nav-number">4.2.0.2.</span> <span class="nav-text">Authorize</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Check-docker-compose-version"><span class="nav-number">4.2.0.3.</span> <span class="nav-text">Check docker-compose version</span></a></li></ol></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Gold_Jack</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">18</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gold-jack.github.io/2022/09/28/notes/Docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Gold_Jack">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jack's Blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Docker | Jack's Blog">
      <meta itemprop="description" content="docker基本命令和原理">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Docker
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2022-09-28 00:00:00 / 修改时间：17:44:44" itemprop="dateCreated datePublished" datetime="2022-09-28T00:00:00+08:00">2022-09-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/notes/" itemprop="url" rel="index"><span itemprop="name">notes</span></a>
        </span>
    </span>

  
    <span id="/2022/09/28/notes/Docker/" class="post-meta-item leancloud_visitors" data-flag-title="Docker" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
</div>

            <div class="post-description">docker基本命令和原理</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="Docker-Basics"><a href="#Docker-Basics" class="headerlink" title="Docker Basics"></a>Docker Basics</h1><h2 id="Docker-Installation-on-Ubuntu"><a href="#Docker-Installation-on-Ubuntu" class="headerlink" title="Docker Installation on Ubuntu"></a>Docker Installation on Ubuntu</h2><p>​		see Docs on  <a target="_blank" rel="noopener" href="https://docs.docker.com/">https://docs.docker.com/</a></p>
<h2 id="How-to-start-Docker-service"><a href="#How-to-start-Docker-service" class="headerlink" title="How to start Docker service"></a>How to start Docker service</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ sudo service docker start</span><br><span class="line"> * Starting Docker: docker                                                           [ OK ]</span><br></pre></td></tr></table></figure>



<h2 id="Basic-Commands"><a href="#Basic-Commands" class="headerlink" title="Basic Commands"></a>Basic Commands</h2><h3 id="Graph"><a href="#Graph" class="headerlink" title="Graph"></a>Graph</h3><p><img src="/./typora-user-images/image-20220609163838158.png" alt="image-20220609163838158"></p>
<h3 id="Docker-Images"><a href="#Docker-Images" class="headerlink" title="Docker Images"></a>Docker Images</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker images		# show all images in this environment</span><br><span class="line">docker search &lt;IMAGE_NAME&gt;		# search specific image in DockerHub(https://hub.docker.com/)</span><br><span class="line">docker pull &lt;IMAGE_NAME&gt;:&lt;IMAGE_VERSION&gt;		# download image from DockerHub</span><br><span class="line">docker run -it &lt;IMAGE_NAME&gt; /bin/bash		# -it: run with interactions </span><br><span class="line">											# -d: run in backstage</span><br><span class="line">											# --name: specify container name</span><br><span class="line">docker rmi &lt;IMAGE_NAME&gt;		# delete image</span><br></pre></td></tr></table></figure>

<h3 id="Docker-Containers"><a href="#Docker-Containers" class="headerlink" title="Docker Containers"></a>Docker Containers</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">docker ps 		# show all containers that are running</span><br><span class="line">docker ps -a	# show all containers</span><br><span class="line">docker rm &lt;CONTAINER_ID&gt; / docker rm &lt;CONTAINER_NAME&gt;	# remove specific container</span><br><span class="line">docker stop &lt;CONTAINER_ID&gt; / ..	# stop this container</span><br><span class="line">docker rm -f $(docker ps -aq)	# remove all containers</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">use <span class="built_in">exit</span> <span class="keyword">in</span> running container can <span class="built_in">exit</span> and stop the container</span></span><br><span class="line">root@1de6ff9112df:/usr/local/tomcat# exit 	</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use ctrl+P+Q can <span class="built_in">exit</span> the container but avoid stopping it</span></span><br><span class="line">^P^Q		</span><br></pre></td></tr></table></figure>

<h3 id="Docker-Volumes"><a href="#Docker-Volumes" class="headerlink" title="Docker Volumes"></a>Docker Volumes</h3><p>Usually, or in currenty study, we use volumes in two situations. One is running a docker image and the other is compiling a Dockerfile.</p>
<blockquote>
<h4 id="run-parameter-v-–volume"><a href="#run-parameter-v-–volume" class="headerlink" title="run parameter(-v, –volume)"></a>run parameter(-v, –volume)</h4></blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. docker run -v &lt;HOST_DIR&gt;:&lt;IMAGE_DIR&gt;	</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">e.g.Mount MySql config:</span>  </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker run -it -v /etc/docker/conf:/usr/docker/conf.v mysql_01 mysql:5.7</span></span><br><span class="line"></span><br><span class="line">2. docker run -v &lt;VOLUME_NAME&gt;</span><br><span class="line"></span><br><span class="line">3. docker run -v &lt;VOLUME_NAME&gt;:&lt;IMAGE_DIR&gt;</span><br></pre></td></tr></table></figure>

<blockquote>
<h4 id="Dockerfile-VOLUME"><a href="#Dockerfile-VOLUME" class="headerlink" title="Dockerfile(VOLUME)"></a>Dockerfile(VOLUME)</h4></blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FROM centos:7</span><br><span class="line"></span><br><span class="line">VOLUME [&quot;volume1&quot;, &quot;volume2&quot;]	# create two volumes in this image</span><br></pre></td></tr></table></figure>

<h3 id="Docker-History"><a href="#Docker-History" class="headerlink" title="Docker History"></a>Docker History</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker history my_centos:0.1</span><br><span class="line">IMAGE          CREATED          CREATED BY                                      SIZE      COMMENT</span><br><span class="line">0c1cc2bcc347   16 minutes ago   /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;/bin…   0B</span><br><span class="line">9103bfeb16e1   16 minutes ago   /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo…   0B</span><br><span class="line">9be46ddfa2fe   16 minutes ago   /bin/sh -c #(nop)  CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo…   0B</span><br><span class="line">7fc193ca45f9   16 minutes ago   /bin/sh -c #(nop)  EXPOSE 80                    0B</span><br><span class="line">d3955d272346   16 minutes ago   /bin/sh -c yum -y install net-tools             171MB</span><br><span class="line">d03960a030ca   16 minutes ago   /bin/sh -c yum -y install vim                   226MB</span><br><span class="line">ecc88ed86c61   16 minutes ago   /bin/sh -c #(nop) WORKDIR /usr/local            0B</span><br><span class="line">80b3acfc39dd   16 minutes ago   /bin/sh -c #(nop)  ENV MYPATH=/usr/local        0B</span><br><span class="line">f8b5cf8ee32e   16 minutes ago   /bin/sh -c #(nop)  MAINTAINER Gold_Jack&lt;gold…   0B</span><br><span class="line">eeb6ee3f44bd   8 months ago     /bin/sh -c #(nop)  CMD [&quot;/bin/bash&quot;]            0B</span><br><span class="line">&lt;missing&gt;      8 months ago     /bin/sh -c #(nop)  LABEL org.label-schema.sc…   0B</span><br><span class="line">&lt;missing&gt;      8 months ago     /bin/sh -c #(nop) ADD file:b3ebbe8bd304723d4…   204MB</span><br></pre></td></tr></table></figure>

<h3 id="Docker-Inspect"><a href="#Docker-Inspect" class="headerlink" title="Docker Inspect"></a>Docker Inspect</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">we can see detailed info by <span class="string">&quot;docker inspect &lt;CONTAINER_ID&gt;&quot;</span></span></span><br><span class="line">jack123@Jack:~$ docker inspect aeb265c66a3f</span><br></pre></td></tr></table></figure>



<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">All commands <span class="keyword">in</span> Dockerfile must be capital</span></span><br><span class="line">FROM basic image	# offical centos is built from scratch</span><br><span class="line">MAINTAINER: owner&lt;@email&gt;	</span><br></pre></td></tr></table></figure>

<p><img src="/./typora-user-images/image-20220608123431133.png" alt="image-20220608123431133"></p>
<h3 id="ENTRYPOINT-and-CMD"><a href="#ENTRYPOINT-and-CMD" class="headerlink" title="ENTRYPOINT and CMD"></a>ENTRYPOINT and CMD</h3><p>ENTRYPOINT and CMD both run commands in Dockerfile. However, when we build an image through this Dockerfile and run it with some additional parameters, differences between ENTRYPOINT and CMD will occur.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker build -f Dockerfile -t test .</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use CMD</span></span><br><span class="line">Dockerfile_CMD:</span><br><span class="line">FROM centos:7</span><br><span class="line">CMD [&quot;ls&quot;, &quot;-a&quot;]</span><br><span class="line"></span><br><span class="line">jack123@Jack:~$ docker run test		# will list all files and directories</span><br><span class="line">jack123@Jack:~$ docker run test -l	# ERROR!</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-l will replace [<span class="string">&quot;ls&quot;</span>, <span class="string">&quot;-a&quot;</span>] <span class="keyword">in</span> Dockerfile_CMD</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">use ENTRYPOINT</span></span><br><span class="line">Dockerfile_ENTRYPOINT:</span><br><span class="line">FROM centos:7</span><br><span class="line">ENTRYPOINT [&quot;ls&quot;, &quot;-a&quot;]</span><br><span class="line"></span><br><span class="line">jack123@Jack:~$ docker run test		# same as above</span><br><span class="line">jack123@Jack:~$ docker run test -l 	# list all</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ENTRYPOINT will attach additional parameters after <span class="string">&quot;docker run&quot;</span> to ENTRYPOINT [<span class="string">&quot;ls&quot;</span>, <span class="string">&quot;-a&quot;</span>]</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">it turns out to be ENTRYPOINT [<span class="string">&quot;ls&quot;</span>, <span class="string">&quot;-a&quot;</span>, <span class="string">&quot;-l&quot;</span>]</span></span><br></pre></td></tr></table></figure>



<h3 id="How-to-build-my-own-image-by-Dockerfile"><a href="#How-to-build-my-own-image-by-Dockerfile" class="headerlink" title="How to build my own image by Dockerfile"></a>How to build my own image by Dockerfile</h3><h4 id="1-write-Dockerfile"><a href="#1-write-Dockerfile" class="headerlink" title="1. write Dockerfile"></a>1. write Dockerfile</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ cat dockerfile_myCentos</span><br></pre></td></tr></table></figure>

<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> centos:<span class="number">7</span>	<span class="comment"># ATTENTION: centos8 is no longer been maintained. Use centos7 instead.</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> Gold_Jack&lt;gold_jack@<span class="number">163</span>.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> MYPATH /usr/local</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> <span class="variable">$MYPATH</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install vim</span></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install net-tools</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="variable">$MYPATH</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&quot;---end---&quot;</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> /bin/bash</span></span><br></pre></td></tr></table></figure>

<h4 id="2-build-myCentos-image"><a href="#2-build-myCentos-image" class="headerlink" title="2. build myCentos image"></a>2. build myCentos image</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker build -f dockerfile_myCentos -t my_centos:0.1 .</span><br><span class="line">jack123@Jack:~$ docker images</span><br><span class="line">REPOSITORY   TAG       IMAGE ID       CREATED         SIZE</span><br><span class="line">my_centos    0.1       0c1cc2bcc347   3 minutes ago   601MB		# my Centos here!</span><br><span class="line">centos       7         eeb6ee3f44bd   8 months ago    204MBtest </span><br></pre></td></tr></table></figure>

<h4 id="3-test-image"><a href="#3-test-image" class="headerlink" title="3. test image"></a>3. test image</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker run -it --name mycentos my_centos:0.1 /bin/bash</span><br><span class="line">[root@03b1aa80c24f local]#</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1. <span class="built_in">test</span> vim</span></span><br><span class="line">[root@03b1aa80c24f local]# cd src</span><br><span class="line">[root@03b1aa80c24f src]# ls</span><br><span class="line">[root@03b1aa80c24f src]# vim a.c</span><br><span class="line">[root@03b1aa80c24f src]# cat a.c</span><br><span class="line">hello myCentos</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">2. <span class="built_in">test</span> ifconfig</span></span><br><span class="line">[root@03b1aa80c24f src]# clear</span><br><span class="line">[root@03b1aa80c24f src]# ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255</span><br><span class="line">        ether 02:42:ac:11:00:02  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 12  bytes 976 (976.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 0  bytes 0 (0.0 B)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<h1 id="Practice-Make-TOMCAT-Image"><a href="#Practice-Make-TOMCAT-Image" class="headerlink" title="Practice: Make TOMCAT Image"></a>Practice: Make TOMCAT Image</h1><h2 id="1-Dockerfile"><a href="#1-Dockerfile" class="headerlink" title="1.Dockerfile"></a>1.Dockerfile</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:/tmp/tomcat$ cat Dockerfile</span><br></pre></td></tr></table></figure>

<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> centos:<span class="number">7</span></span><br><span class="line"><span class="keyword">MAINTAINER</span> jack&lt;gold_jack@<span class="number">163</span>.com&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> readme.txt /usr/local/readme.txt</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> apache-tomcat-9.0.63.tar.gz /usr/local/</span></span><br><span class="line"><span class="keyword">ADD</span><span class="language-bash"> jdk-8u221-linux-x64.tar.gz /usr/local/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> yum -y install vim</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> MYPATH /usr/local/</span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> <span class="variable">$MYPATH</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment"># jdk &lt;DIR_NAME&gt; must corresponding to the dir name in image.</span></span><br><span class="line"><span class="comment"># so build image first and then enter into container to see what the dir name is.</span></span><br><span class="line"><span class="comment"># then stop and remove container, remove image</span></span><br><span class="line"><span class="comment"># edit the Dockerfile and re-build image</span></span><br><span class="line"><span class="comment"># for example, I use jdk8, and the &lt;DIR_NAME&gt; is jdk1.8.0_221 in the container</span></span><br><span class="line"><span class="keyword">ENV</span> JAVA_HOME /usr/local/jdk1.<span class="number">8.0</span>_221	</span><br><span class="line"><span class="keyword">ENV</span> CLASSPATH $JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar</span><br><span class="line"></span><br><span class="line"><span class="keyword">ENV</span> CATALINA_HOME /usr/local/apache-tomcat-<span class="number">9.0</span>.<span class="number">63</span></span><br><span class="line"><span class="keyword">ENV</span> CATALINA_BASH /usr/local/apache-tomcat-<span class="number">9.0</span>.<span class="number">63</span></span><br><span class="line"><span class="keyword">ENV</span> PATH $PATH:$JAVA_HOME/bin:$CATALINA_HOME/bin:$CATALINA_HOME/lib</span><br><span class="line"></span><br><span class="line"><span class="keyword">EXPOSE</span> <span class="number">8080</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> /usr/local/apache-tomcat-9.0.63/bin/startup.sh &amp;&amp; <span class="built_in">tail</span> -F /usr/local/apache-tomcat-9.0.63/bin/logs/catalin</span></span><br></pre></td></tr></table></figure>

<h2 id="2-build-Image"><a href="#2-build-Image" class="headerlink" title="2.build Image"></a>2.build Image</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:/tmp/tomcat$ docker build -t mytomcat .</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">if</span> <span class="string">&#x27;no permission to read from &#x27;</span>/tmp/tomcat/logs/catalina.out<span class="string">&#x27;&#x27;</span>.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use sudo</span></span><br><span class="line">jack123@Jack:/tmp/tomcat$ sudo docker build -t mytomcat .</span><br></pre></td></tr></table></figure>

<h2 id="3-Run-Iamge"><a href="#3-Run-Iamge" class="headerlink" title="3.Run Iamge"></a>3.Run Iamge</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:/tmp/tomcat$ docker run -d --name mytomcat01 \</span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">-p 9000:8080 \</span></span><br><span class="line"><span class="language-bash">&gt; -v /tmp/tomcat/test/:/usr/local/apache-tomcat-9.0.63/webapps/test \</span></span><br><span class="line"><span class="language-bash">&gt; -v /tmp/tomcat/logs/:/usr/local/apache-tomcat-9.0.63/logs \</span></span><br><span class="line"><span class="language-bash">&gt; mytomcat</span></span><br><span class="line">4106f28af916151471cc535ac2b06fea24b6b36eeb9e21ed09ffeee56c5f29ba</span><br><span class="line"></span><br><span class="line">jack123@Jack:/tmp/tomcat$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE      COMMAND                  CREATED        STATUS        PORTS                                       NAMES</span><br><span class="line">4106f28af916   mytomcat   &quot;/bin/sh -c &#x27;/usr/lo…&quot;   1 second ago   Up 1 second   0.0.0.0:9000-&gt;8080/tcp, :::9000-&gt;8080/tcp   mytomcat01</span><br></pre></td></tr></table></figure>

<h2 id="4-Test-Connection"><a href="#4-Test-Connection" class="headerlink" title="4.Test Connection"></a>4.Test Connection</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:/tmp/tomcat$ curl localhost:9000 -I	#  -I, --head  Show document info only</span><br><span class="line">HTTP/1.1 200</span><br><span class="line">Content-Type: text/html;charset=UTF-8</span><br><span class="line">Transfer-Encoding: chunked</span><br><span class="line">Date: Thu, 09 Jun 2022 04:18:46 GMT</span><br></pre></td></tr></table></figure>

<h2 id="5-Create-WEB-INF-x2F-web-xml"><a href="#5-Create-WEB-INF-x2F-web-xml" class="headerlink" title="5.Create WEB_INF&#x2F;web.xml"></a>5.Create WEB_INF&#x2F;web.xml</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">web.xml<span class="string">&#x27;s content is fixed</span></span></span><br><span class="line">jack123@Jack:/tmp/tomcat/test/WEB_INF$ cat web.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">&quot;3.0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="6-Create-index-jsp"><a href="#6-Create-index-jsp" class="headerlink" title="6.Create index.jsp"></a>6.Create index.jsp</h2><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">jack123<span class="meta">@Jack</span>:/tmp/tomcat/test$ sudo vim index.jsp</span><br><span class="line">jack123<span class="meta">@Jack</span>:/tmp/tomcat/test$ cat index.jsp</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">        System.out.println(<span class="string">&quot;\nWe have successfully opened this tomcat server.&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;h2&gt;Hello World!&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="7-Test-localhost-9090-x2F-test"><a href="#7-Test-localhost-9090-x2F-test" class="headerlink" title="7.Test localhost:9090&#x2F;test"></a>7.Test localhost:9090&#x2F;test</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl localhost:9090/test ---&gt; success return &quot;Hello World&quot;</span><br></pre></td></tr></table></figure>



<h2 id="8-Check-logs"><a href="#8-Check-logs" class="headerlink" title="8.Check logs"></a>8.Check logs</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:/tmp/tomcat/logs$ sudo cat catalina.out</span><br><span class="line">//</span><br><span class="line">......</span><br><span class="line">//</span><br><span class="line">We have successfully opened this tomcat server.</span><br><span class="line"></span><br><span class="line">We have successfully opened this tomcat server.</span><br><span class="line"></span><br><span class="line">We have successfully opened this tomcat server.</span><br><span class="line"></span><br><span class="line">We have successfully opened this tomcat server.</span><br><span class="line"></span><br><span class="line">We have successfully opened this tomcat server.</span><br><span class="line"></span><br><span class="line">We have successfully opened this tomcat server.</span><br><span class="line"></span><br><span class="line">We have successfully opened this tomcat server.</span><br><span class="line"></span><br><span class="line">We have successfully opened this tomcat server.</span><br><span class="line"></span><br><span class="line">We have successfully opened this tomcat server.</span><br></pre></td></tr></table></figure>

<h2 id="9-Push-MyTomcat-to-DockerHub"><a href="#9-Push-MyTomcat-to-DockerHub" class="headerlink" title="9.Push MyTomcat to DockerHub"></a>9.Push MyTomcat to DockerHub</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">login to DockerHub</span></span><br><span class="line">jack123@Jack:/tmp/tomcat/logs$ docker login -u &lt;USERNAME&gt; -p &lt;PASSWORD&gt;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">change tag and repository name</span></span><br><span class="line">jack123@Jack:/tmp/tomcat/logs$ docker tag mytomcat goldjack/tomcat:1.0</span><br><span class="line">jack123@Jack:/tmp/tomcat/logs$ docker images</span><br><span class="line">REPOSITORY        TAG       IMAGE ID       CREATED          SIZE</span><br><span class="line">goldjack/tomcat   1.0       18069f342233   59 minutes ago   853MB</span><br><span class="line">mytomcat          latest    18069f342233   59 minutes ago   853MB</span><br><span class="line">my_centos         0.1       0c1cc2bcc347   24 hours ago     601MB</span><br><span class="line">centos            7         eeb6ee3f44bd   8 months ago     204MB</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">push my image to DockerHub</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">iamge is commited <span class="keyword">in</span> layers!</span></span><br><span class="line">jack123@Jack:/tmp/tomcat/logs$ docker push goldjack/tomcat:1.0</span><br><span class="line">The push refers to repository [docker.io/goldjack/tomcat]</span><br><span class="line">2295ae19f1d2: Pushed</span><br><span class="line">6510d41890d9: Pushed</span><br><span class="line">f1447c90adfb: Pushed</span><br><span class="line">97f68fd24610: Pushed</span><br><span class="line">174f56854903: Mounted from library/centos</span><br><span class="line">1.0: digest: sha256:393dec84d04d28b905011d1b020ef90dbea3d4c35842fff7a1726f983dbb4df6 size: 1373</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">log</span> out</span></span><br><span class="line">jack123@Jack:/tmp/tomcat/logs$ docker logout</span><br><span class="line">Removing login credentials for https://index.docker.io/v1/</span><br></pre></td></tr></table></figure>

<h1 id="Docker-Network"><a href="#Docker-Network" class="headerlink" title="Docker Network"></a>Docker Network</h1><p>PRE: remove all images and containers.</p>
<h2 id="How-does-docker-handle-container-network-access"><a href="#How-does-docker-handle-container-network-access" class="headerlink" title="How does docker handle container network access?"></a>How does docker handle container network access?</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">run tomcat</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-P, --publish-all                    Publish all exposed ports to random ports</span></span><br><span class="line">jack123@Jack:/tmp/tomcat/logs$ docker run -d -P --name tomcat01 tomcat</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">IP info</span></span><br><span class="line">jack123@Jack:/tmp/tomcat/logs$ docker exec -it tomcat01 /bin/bash</span><br><span class="line">root@1de6ff9112df:/usr/local/tomcat# ip a</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: tunl0@NONE: &lt;NOARP&gt; mtu 1480 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/ipip 0.0.0.0 brd 0.0.0.0</span><br><span class="line">3: sit0@NONE: &lt;NOARP&gt; mtu 1480 qdisc noop state DOWN group default qlen 1000</span><br><span class="line">    link/sit 0.0.0.0 brd 0.0.0.0</span><br><span class="line">28: eth0@if29: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default</span><br><span class="line">    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0</span><br><span class="line">    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">       </span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ping IP: Success</span></span><br><span class="line">jack123@Jack:/$ ping 172.17.0.2</span><br><span class="line">PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.056 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.091 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.093 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=4 ttl=64 time=0.092 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=5 ttl=64 time=0.086 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=6 ttl=64 time=0.093 ms</span><br><span class="line">^C</span><br><span class="line">--- 172.17.0.2 ping statistics ---</span><br><span class="line">6 packets transmitted, 6 received, 0% packet loss, time 5225ms</span><br><span class="line">rtt min/avg/max/mdev = 0.056/0.085/0.093/0.013 ms</span><br></pre></td></tr></table></figure>

<h2 id="Veth-pair"><a href="#Veth-pair" class="headerlink" title="Veth-pair"></a>Veth-pair</h2><p>Veth-pair is a virtual device interface that shows in pairs. It connects to Network Stack in one direction and connects to  its partners in the other. It is often used in Linux Bridge.</p>
<h2 id="Communication-Process"><a href="#Communication-Process" class="headerlink" title="Communication Process"></a>Communication Process</h2><p><img src="/./typora-user-images/image-20220609180550711.png" alt="image-20220609180550711"></p>
<p>In the diagram above, the Main Router, also referred to as Docker0, holds one IP(172.17.0.1). Other images such as Tomcat01 and Tomcat02 will be allocated two numbers, usually continuous, as their communication interface to the Main Router. </p>
<p>When Tomcat01 sends a request to Tomcat02, it is not the direct communication between two containers but through the Main Router(Docker0).</p>
<ol>
<li>Tomcat01 sends a request to Docker0 through port 261.</li>
<li>Docker0 receives the request from port 262 because veth<ID>@if261 is true.</li>
<li>Docker0 will store the IP of Tomcat01 if it was not in the Routing Table. (When Docker service initialized, its routing table only possesses the IP of itself, usually 172.17.0.1. Only when the Main Router receives a request from a  new IP, it will consequently update its routing table.)</li>
<li>Docker0 broadcasts the request through all ports.</li>
<li>Tomcat02 receives the request from port 263 because eth0@if264 is true and the request’s target address is 172.17.0.3.</li>
</ol>
<p>Conclusion: All Docker containers run in local area network(LAN), so they can communicate with each other through the Main Router(Docker0).</p>
<h2 id="Ping-Test"><a href="#Ping-Test" class="headerlink" title="Ping Test"></a>Ping Test</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">run two containers: tomcat01 and tomcat02</span></span><br><span class="line">jack123@Jack:~$ docker ps</span><br><span class="line">CONTAINER ID   IMAGE     COMMAND             CREATED         STATUS         PORTS                                         NAMES</span><br><span class="line">63d426e83ddb   tomcat    &quot;catalina.sh run&quot;   8 minutes ago   Up 8 minutes   0.0.0.0:49154-&gt;8080/tcp, :::49154-&gt;8080/tcp   tomcat02</span><br><span class="line">1de6ff9112df   tomcat    &quot;catalina.sh run&quot;   2 hours ago     Up 2 hours     0.0.0.0:49153-&gt;8080/tcp, :::49153-&gt;8080/tcp   tomcat01</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use ip addr to check each containers<span class="string">&#x27; IP address</span></span></span><br><span class="line">tomcat01: 172.17.0.2</span><br><span class="line">tomcat02: 172.17.0.3</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">Before Ping, we should install dependencies and utils</span></span></span><br><span class="line">apt update</span><br><span class="line">apt-get update</span><br><span class="line">apt install -y iproute2		# to make &quot;ip a&quot; Runnalbe</span><br><span class="line">apt-get install inetutils-ping # to make &quot;ping&quot; Runnable</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="string">ping tomcat02 in tomcat01: Success</span></span></span><br><span class="line">root@1de6ff9112df:/usr/local/tomcat# ping 172.17.0.3</span><br><span class="line">PING 172.17.0.3 (172.17.0.3): 56 data bytes</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=0 ttl=64 time=0.077 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=1 ttl=64 time=0.126 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=2 ttl=64 time=0.135 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=3 ttl=64 time=0.121 ms</span><br><span class="line">64 bytes from 172.17.0.3: icmp_seq=4 ttl=64 time=0.109 ms</span><br><span class="line">^C--- 172.17.0.3 ping statistics ---</span><br><span class="line">5 packets transmitted, 5 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.077/0.114/0.135/0.000 ms</span><br></pre></td></tr></table></figure>

<h2 id="–link"><a href="#–link" class="headerlink" title="–link"></a>–link</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">use --<span class="built_in">link</span> can connect one container to another without knowing concrete IP</span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">firstly, we have to ensure that the anchored container(tomcat01) is running</span></span><br><span class="line">docker: Error response from daemon: Cannot link to a non running container: /tomcat01 AS /tomcat02/tomcat01.</span><br><span class="line">jack123@Jack:~$ docker start tomcat01</span><br><span class="line">tomcat01</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Then, we can run tomcat02 can connect it to tomcat01</span></span><br><span class="line">jack123@Jack:~$ docker run -d -P --name tomcat02 --link tomcat01 tomcat</span><br><span class="line">88ee3d6a91cb4449138f371508b273ae3b9faa98a564b4430fbb3a3e5f63d2bb</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Ping <span class="built_in">test</span></span></span><br><span class="line">jack123@Jack:~$ docker exec -it tomcat02 ping tomcat01</span><br><span class="line">PING tomcat01 (172.17.0.2): 56 data bytes</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=0 ttl=64 time=0.058 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.201 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.160 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.215 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=4 ttl=64 time=0.230 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=5 ttl=64 time=0.264 ms</span><br><span class="line">64 bytes from 172.17.0.2: icmp_seq=6 ttl=64 time=0.204 ms</span><br><span class="line">^C--- tomcat01 ping statistics ---</span><br><span class="line">7 packets transmitted, 7 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.058/0.190/0.264/0.061 ms</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">BUT!!! reverse ping is denied</span></span><br><span class="line">jack123@Jack:~$ docker exec -it tomcat01 ping tomcat02</span><br><span class="line">ping: unknown host</span><br></pre></td></tr></table></figure>

<h2 id="Network-Inspect"><a href="#Network-Inspect" class="headerlink" title="Network Inspect"></a>Network Inspect</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">5c25881d40ff   bridge    bridge    local	# Docker0</span><br><span class="line">3d27af74540a   host      host      local</span><br><span class="line">68bf3a526a05   none      null      local</span><br><span class="line"></span><br><span class="line">jack123@Jack:~$ docker network inspect 5c25881d40ff</span><br></pre></td></tr></table></figure>

<p><img src="/./typora-user-images/image-20220610113447054.png" alt="image-20220610113447054"><img src="/./typora-user-images/image-20220610113524356.png" alt="image-20220610113524356"></p>
<h2 id="Hosts"><a href="#Hosts" class="headerlink" title="Hosts"></a>Hosts</h2><p>The operation of –link <NAME> is fundamentally add a “<IP>    <NAME>“  pair into hosts. </p>
<p>For now, it is “172.17.0.2    tomcat01    <CONTAINER_ID>“</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker exec -it tomcat02 /bin/bash</span><br><span class="line">root@88ee3d6a91cb:/etc# cat hosts</span><br><span class="line">127.0.0.1       localhost</span><br><span class="line">::1     localhost ip6-localhost ip6-loopback</span><br><span class="line">fe00::0 ip6-localnet</span><br><span class="line">ff00::0 ip6-mcastprefix</span><br><span class="line">ff02::1 ip6-allnodes</span><br><span class="line">ff02::2 ip6-allrouters</span><br><span class="line">172.17.0.2      tomcat01 1de6ff9112df		# in tomcat02:/etc/hosts, we can see tomcat02 bound 											  to tomcat 01</span><br><span class="line">172.17.0.3      88ee3d6a91cb</span><br></pre></td></tr></table></figure>

<h2 id="Create-My-Network"><a href="#Create-My-Network" class="headerlink" title="Create My Network"></a>Create My Network</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">when we use commands below to run a image</span></span><br><span class="line">docker run -d -P tomcat01 tomcat</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">it hides a default parameter --net bridge, <span class="built_in">which</span> equals</span></span><br><span class="line">docker run -d -P tomcat01 --net bridge tomcat</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">and bridge here means Docker0</span></span><br></pre></td></tr></table></figure>

<h3 id="Customize-My-Network"><a href="#Customize-My-Network" class="headerlink" title="Customize My Network"></a>Customize My Network</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--driver bridge: use bridge to connect</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--subnet 192.168.0.0/16: sub networks range from 192.168.0.2~192.168.255.255</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--gateway 192.168.0.1</span></span><br><span class="line">jack123@Jack:~$ docker network create --driver bridge --subnet 192.168.0.0/16 --gateway 192.168.0.1 mynet</span><br><span class="line">860a478371a3444a665ec9f2fe41e61a1dffc1b6d67a280f5b3d41d78947eca9</span><br></pre></td></tr></table></figure>

<h3 id="Inspect-Mynet"><a href="#Inspect-Mynet" class="headerlink" title="Inspect Mynet"></a>Inspect Mynet</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker network ls</span><br><span class="line">NETWORK ID     NAME      DRIVER    SCOPE</span><br><span class="line">5c25881d40ff   bridge    bridge    local</span><br><span class="line">3d27af74540a   host      host      local</span><br><span class="line">860a478371a3   mynet     bridge    local		# mynet</span><br><span class="line">68bf3a526a05   none      null      local</span><br><span class="line">jack123@Jack:~$ docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;860a478371a3444a665ec9f2fe41e61a1dffc1b6d67a280f5b3d41d78947eca9&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2022-06-10T12:20:58.52555606+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,		# --driver</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,		# --subnet</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;		# --gateway</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<h3 id="Create-Two-Tomcats-Running-in-Mynet"><a href="#Create-Two-Tomcats-Running-in-Mynet" class="headerlink" title="Create Two Tomcats Running in Mynet"></a>Create Two Tomcats Running in Mynet</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker run -d -P --name tomcat-net-01 --net mynet tomcat</span><br><span class="line">84fcf554af5184e62418349a8bb63ad61e7f9190a459990111a7b5aec634ee96</span><br><span class="line">jack123@Jack:~$ docker run -d -P --name tomcat-net-02 --net mynet tomcat</span><br><span class="line">7e63e7edb8c6fe26e98a7b187b598b248e8dbcf0df03526a342af11faf7d82ed</span><br></pre></td></tr></table></figure>

<h3 id="Again-Inspect-Mynet"><a href="#Again-Inspect-Mynet" class="headerlink" title="Again: Inspect Mynet"></a>Again: Inspect Mynet</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">jack123@Jack:~$ docker network inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;860a478371a3444a665ec9f2fe41e61a1dffc1b6d67a280f5b3d41d78947eca9&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2022-06-10T12:20:58.52555606+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;</span><br><span class="line">            &quot;7e63e7edb8c6fe26e98a7b187b598b248e8dbcf0df03526a342af11faf7d82ed&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat-net-02&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;4a34bcb2e451ccddd7496b0766a2c24e45bd7c739a10f9ae053afe241e689ecf&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;84fcf554af5184e62418349a8bb63ad61e7f9190a459990111a7b5aec634ee96&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat-net-01&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;314e2043f15e9420ba48a81c7b2e5ce7a57af0d5e65a670b32d16350cc2a2fb1&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p>we can see two Tomcat servers running in mynet which were allocated IP 192.168.0.2 and 192.168.0.1.</p>
<h3 id="Ping-Test-Between-Tomcat-net-01-and-Tomcat-net-02"><a href="#Ping-Test-Between-Tomcat-net-01-and-Tomcat-net-02" class="headerlink" title="Ping Test Between Tomcat-net-01 and Tomcat-net-02"></a>Ping Test Between Tomcat-net-01 and Tomcat-net-02</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ping IP</span></span><br><span class="line">jack123@Jack:~$ docker exec -it tomcat-net-01 ping 192.168.0.3</span><br><span class="line">PING 192.168.0.3 (192.168.0.3): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=0 ttl=64 time=0.065 ms</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=1 ttl=64 time=0.125 ms</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=2 ttl=64 time=0.098 ms</span><br><span class="line">64 bytes from 192.168.0.3: icmp_seq=3 ttl=64 time=0.121 ms</span><br><span class="line">^C--- 192.168.0.3 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.065/0.102/0.125/0.024 ms</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ping container name</span></span><br><span class="line">jack123@Jack:~$ docker exec -it tomcat-net-02 ping tomcat-net-01</span><br><span class="line">PING tomcat-net-01 (192.168.0.2): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=0 ttl=64 time=0.037 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=1 ttl=64 time=0.130 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=2 ttl=64 time=0.152 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=3 ttl=64 time=0.159 ms</span><br><span class="line">^C--- tomcat-net-01 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.037/0.119/0.159/0.049 ms</span><br></pre></td></tr></table></figure>

<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h3><p>Customized network can avoid the flaws of Docker0. If we are to deploy docker swarms like redis and mysql, we can create two networks such as redis-net and mysql-net. Because two networks are isolated, the redis server and the mysql server have no mutual interference.</p>
<h3 id="New-Container-to-Mynet"><a href="#New-Container-to-Mynet" class="headerlink" title="New Container to Mynet"></a>New Container to Mynet</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">create new tomcat01</span></span><br><span class="line">jack123@Jack:~$ docker run -d -P --name tomcat01 tomcat</span><br><span class="line">d58690b58cf9085c6bac8240c317c873f6c4072453dcd28290ae63c4e09d0e27</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">docker network connect INFO</span></span><br><span class="line">jack123@Jack:~$ docker network connect --help</span><br><span class="line">Usage:  docker network connect [OPTIONS] NETWORK CONTAINER</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">connect tomcat01 to mynet</span></span><br><span class="line">jack123@Jack:~$ docker network connect mynet tomcat01	# run successfully</span><br><span class="line">jack123@Jack:~$ docker inspect mynet</span><br><span class="line">[</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;Name&quot;: &quot;mynet&quot;,</span><br><span class="line">        &quot;Id&quot;: &quot;860a478371a3444a665ec9f2fe41e61a1dffc1b6d67a280f5b3d41d78947eca9&quot;,</span><br><span class="line">        &quot;Created&quot;: &quot;2022-06-10T12:20:58.52555606+08:00&quot;,</span><br><span class="line">        &quot;Scope&quot;: &quot;local&quot;,</span><br><span class="line">        &quot;Driver&quot;: &quot;bridge&quot;,</span><br><span class="line">        &quot;EnableIPv6&quot;: false,</span><br><span class="line">        &quot;IPAM&quot;: &#123;</span><br><span class="line">            &quot;Driver&quot;: &quot;default&quot;,</span><br><span class="line">            &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">            &quot;Config&quot;: [</span><br><span class="line">                &#123;</span><br><span class="line">                    &quot;Subnet&quot;: &quot;192.168.0.0/16&quot;,</span><br><span class="line">                    &quot;Gateway&quot;: &quot;192.168.0.1&quot;</span><br><span class="line">                &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Internal&quot;: false,</span><br><span class="line">        &quot;Attachable&quot;: false,</span><br><span class="line">        &quot;Ingress&quot;: false,</span><br><span class="line">        &quot;ConfigFrom&quot;: &#123;</span><br><span class="line">            &quot;Network&quot;: &quot;&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;ConfigOnly&quot;: false,</span><br><span class="line">        &quot;Containers&quot;: &#123;</span><br><span class="line">            &quot;7e63e7edb8c6fe26e98a7b187b598b248e8dbcf0df03526a342af11faf7d82ed&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat-net-02&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;4a34bcb2e451ccddd7496b0766a2c24e45bd7c739a10f9ae053afe241e689ecf&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:03&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.3/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;84fcf554af5184e62418349a8bb63ad61e7f9190a459990111a7b5aec634ee96&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat-net-01&quot;,</span><br><span class="line">                &quot;EndpointID&quot;: &quot;314e2043f15e9420ba48a81c7b2e5ce7a57af0d5e65a670b32d16350cc2a2fb1&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:02&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.2/16&quot;,</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;,</span><br><span class="line">            &quot;d58690b58cf9085c6bac8240c317c873f6c4072453dcd28290ae63c4e09d0e27&quot;: &#123;</span><br><span class="line">                &quot;Name&quot;: &quot;tomcat01&quot;,		# new tomcat01 was connected to mynet</span><br><span class="line">                &quot;EndpointID&quot;: &quot;363e4fac8b35b7b85ba220c5b461111ec96b03ec505af3184d33e9dd356d8072&quot;,</span><br><span class="line">                &quot;MacAddress&quot;: &quot;02:42:c0:a8:00:04&quot;,</span><br><span class="line">                &quot;IPv4Address&quot;: &quot;192.168.0.4/16&quot;,		# allocated IP</span><br><span class="line">                &quot;IPv6Address&quot;: &quot;&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;Options&quot;: &#123;&#125;,</span><br><span class="line">        &quot;Labels&quot;: &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ping <span class="built_in">test</span> between new tomcat01 and two old tomcats</span></span><br><span class="line">jack123@Jack:~$ docker exec -it tomcat01 ping tomcat-net-01</span><br><span class="line">PING tomcat-net-01 (192.168.0.2): 56 data bytes</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=0 ttl=64 time=0.061 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=1 ttl=64 time=0.132 ms</span><br><span class="line">64 bytes from 192.168.0.2: icmp_seq=2 ttl=64 time=0.119 ms</span><br><span class="line">^C--- tomcat-net-01 ping statistics ---</span><br><span class="line">3 packets transmitted, 3 packets received, 0% packet loss</span><br><span class="line">round-trip min/avg/max/stddev = 0.061/0.104/0.132/0.031 ms</span><br></pre></td></tr></table></figure>

<h3 id="Two-IP-One-Container"><a href="#Two-IP-One-Container" class="headerlink" title="Two IP One Container"></a>Two IP One Container</h3><p>For tomcat01, it has IP:172.17.0.2 in Docker0. Meanwhile, because it has been connected to mynet, it also possesses IP:192.168.0.4 in mynet. This is the situation that one container has two IPs. </p>
<p><strong>Similar to private net IP and public net IP in real router.</strong></p>
<h1 id="Docker-compose"><a href="#Docker-compose" class="headerlink" title="Docker-compose"></a>Docker-compose</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><p>Compose is a tool for defining and running multi-container Docker applications. With Compose, you use a YAML file to configure your application’s services. Then, with a single command, you create and start all the services from your configuration. To learn more about all the features of Compose, see <a target="_blank" rel="noopener" href="https://docs.docker.com/compose/#features">the list of features</a>.</p>
<p>Compose works in all environments: production, staging, development, testing, as well as CI workflows. You can learn more about each case in <a target="_blank" rel="noopener" href="https://docs.docker.com/compose/#common-use-cases">Common Use Cases</a>.</p>
<p>Using Compose is basically a three-step process:</p>
<ol>
<li>Define your app’s environment with a <code>Dockerfile</code> so it can be reproduced anywhere.</li>
<li>Define the services that make up your app in <code>docker-compose.yml</code> so they can be run together in an isolated environment.</li>
<li>Run <code>docker compose up</code> and the <a target="_blank" rel="noopener" href="https://docs.docker.com/compose/#compose-v2-and-the-new-docker-compose-command">Docker compose command</a> starts and runs your entire app. You can alternatively run <code>docker-compose up</code> using the docker-compose binary.</li>
</ol>
<h2 id="Intallation"><a href="#Intallation" class="headerlink" title="Intallation"></a>Intallation</h2><blockquote>
<h4 id="Download-Docker-compose"><a href="#Download-Docker-compose" class="headerlink" title="Download Docker-compose"></a>Download Docker-compose</h4></blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo curl -L https://github.com/docker/compose/releases/download/1.17.0/docker-compose-`uname -s`-`uname -m` -o /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<blockquote>
<h4 id="Authorize"><a href="#Authorize" class="headerlink" title="Authorize"></a>Authorize</h4></blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chmod +x /usr/local/bin/docker-compose</span><br></pre></td></tr></table></figure>

<blockquote>
<h4 id="Check-docker-compose-version"><a href="#Check-docker-compose-version" class="headerlink" title="Check docker-compose version"></a>Check docker-compose version</h4></blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">docker-compose --version</span><br><span class="line"></span><br><span class="line">docker-compose version 1.17.0, build ac53b73</span><br><span class="line">docker-py version: 2.5.1</span><br><span class="line">CPython version: 2.7.13</span><br><span class="line">OpenSSL version: OpenSSL 1.0.1t  3 May 2016</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/middleware/" rel="tag"># middleware</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/09/28/notes/Mybatis-Plus/" rel="prev" title="Mybatis-Plus">
                  <i class="fa fa-chevron-left"></i> Mybatis-Plus
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/09/28/notes/Airport-Management/" rel="next" title="AirportManagement Project">
                  AirportManagement Project <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments gitalk-container"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv">本站总访问量<span id="busuanzi_value_site_pv"></span>次</span>

<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Gold_Jack</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"ZuxMbPORrgeaVv5XqzOV6utJ-gzGzoHsz","app_key":"I1vYT2AZk16Ha4lTZhpUNehC","server_url":null,"security":false}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>


<script src="https://unpkg.com/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script>

<script>
var options = {
  bottom: '32px',
  right: '32px',
  left: 'unset',
  time: '0.5s',
  mixColor: 'transparent',
  backgroundColor: 'transparent',
  buttonColorDark: '#100f2c',
  buttonColorLight: '#fff',
  saveInCookies: true,
  label: '🌓',
  autoMatchOsTheme: true
}
const darkmode = new Darkmode(options);
window.darkmode = darkmode;
darkmode.showWidget();
</script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.css" integrity="sha256-AJnUHL7dBv6PGaeyPQJcgQPDjt/Hn/PvYZde1iqfp8U=" crossorigin="anonymous">

<script class="next-config" data-name="gitalk" type="application/json">{"enable":true,"github_id":"Gold-Jack","repo":"hexo-gitalk-comments","client_id":"5ac0eefff2b116be641e","client_secret":"336d27febb3f405acd38cd83c22cb840ec95b5b9","admin_user":"Gold-Jack","distraction_free_mode":true,"proxy":"https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token","language":null,"js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/gitalk/1.8.0/gitalk.min.js","integrity":"sha256-MVK9MGD/XJaGyIghSVrONSnoXoGh3IFxLw0zfvzpxR4="},"path_md5":"86fad738b084f56c3472ac4f66432f8b"}</script>
<script src="/js/third-party/comments/gitalk.js"></script>

</body>
</html>
